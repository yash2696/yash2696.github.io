<?xml version="1.0" encoding="utf-8"?> 
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en-us">
    <generator uri="https://gohugo.io/" version="0.68.3">Hugo</generator><title type="html"><![CDATA[Github on /dev/yash/notes]]></title>
    
        <subtitle type="html"><![CDATA[The directory of my thoughts]]></subtitle>
    
    
    
            <link href="https://yashagarwal.in/tags/github/" rel="alternate" type="text/html" title="HTML" />
            <link href="https://yashagarwal.in/tags/github/index.xml" rel="alternate" type="application/rss+xml" title="RSS" />
            <link href="https://yashagarwal.in/tags/github/atom.xml" rel="self" type="application/atom+xml" title="Atom" />
            <link href="https://yashagarwal.in/tags/github/jf2feed.json" rel="alternate" type="application/jf2feed+json" title="jf2feed" />
    <updated>2020-03-31T12:08:56+00:00</updated>
    
    
    <author>
            <name>Yash Agarwal</name>
            
                <email>yashagarwaljpr@gmail.com</email>
            </author>
    
        <id>https://yashagarwal.in/tags/github/</id>
    
        
        <entry>
            <title type="html"><![CDATA[My Own Configuration Manager]]></title>
            <link href="https://yashagarwal.in/posts/2018/01/my-own-configuration-manager/?utm_source=atom_feed" rel="alternate" type="text/html" />
            
            
                <id>https://yashagarwal.in/posts/2018/01/my-own-configuration-manager/</id>
            
            
                    <author>
                        <name>Yash Agarwal</name>
                    </author>
            <published>2018-01-21T11:23:23+05:30</published>
            <updated>2018-01-21T11:23:23+05:30</updated>
            
            
            <content type="html"><![CDATA[<p>I have been using Linux since I was in my second year of undergraduate. My experiments with the dotfiles (configuration files) also started at the same time. For the uninformed, in Linux, it is common to configure a lot of settings and configurations within dotfiles. Dotfiles are files in a Linux user&rsquo;s home directory that begin with a dot or a full-stop character. This dot indicates to the operating system that these files are used to store the settings of programs like <code>vim</code> or shells like <code>bash</code> or <code>fish</code> to name a few.</p>
<p>In the beginning, I was keeping a manual backup of my dotfiles by copying them to a folder from time to time. But the list soon started getting huge, that it became complicated for me to keep track of the changes. Then I moved to symlinks. I started symlinking all the dotfiles from my folder to their usual locations. This setup worked perfectly fine, but as my collection of dotfiles grew, It became very cumbersome for me to symlink every dotfile manually.</p>
<p>I also tried a few tools built for this particular purpose. Some of them are <code>vcsh</code>, <code>mr</code>, and <code>stow</code>. These tools work just fine, but I was not willing to learn new tools just for maintaining my dotfiles. At last, I decided to write my tool to solve this problem. This way, there will not be any external dependency, and this tool will also become part of my dotfiles.</p>
<h2 id="design">Design</h2>
<p>The tool, in itself, is inspired by the <a href="https://en.wikipedia.org/wiki/Configuration_file#UNIX/Linux">UNIX tradition</a> of keeping configuration files for the settings of the programs. This configuration system uses a JSON formatted dotfile.</p>
<p><a href="https://github.com/yashhere/ConMan">Here</a> is the source code for the configuration system. Let&rsquo;s have a look at the file structure of the repository.
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">|-- .backups
|   |-- 08-01-2018-15:47
|   |-- 08-01-2018-19:30
|   |-- ......
|-- configure.py
|-- current_status
|-- dotfiles
|   |-- dunst
|   |-- gtk-3.0
|   |-- i3
|   |-- ......
|-- dotfiles.json
|-- LICENSE
`-- README.md</code></pre></div></p>
<p>During the initial setup, you need to edit the <code>dotfiles.json</code> file to suit your setup. A relevant section of the JSON file is given below.
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;pre&#34;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;cloning repository&#34;</span><span class="p">,</span>
      <span class="nt">&#34;command&#34;</span><span class="p">:</span> <span class="s2">&#34;git&#34;</span><span class="p">,</span>
      <span class="nt">&#34;subcommand&#34;</span><span class="p">:</span> <span class="s2">&#34;clone&#34;</span><span class="p">,</span>
      <span class="nt">&#34;argument&#34;</span><span class="p">:</span> <span class="s2">&#34;https://github.com/yashhere/dotfiles.git&#34;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&#34;linking&#34;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bashrc&#34;</span><span class="p">,</span>
        <span class="nt">&#34;src&#34;</span><span class="p">:</span> <span class="s2">&#34;dotfiles/.bashrc&#34;</span><span class="p">,</span>
        <span class="nt">&#34;dest&#34;</span><span class="p">:</span> <span class="s2">&#34;.bashrc&#34;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;bash_profile&#34;</span><span class="p">,</span>
        <span class="nt">&#34;src&#34;</span><span class="p">:</span> <span class="s2">&#34;dotfiles/.bash_profile&#34;</span><span class="p">,</span>
        <span class="nt">&#34;dest&#34;</span><span class="p">:</span> <span class="s2">&#34;.bash_profile&#34;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;profile&#34;</span><span class="p">,</span>
        <span class="nt">&#34;src&#34;</span><span class="p">:</span> <span class="s2">&#34;dotfiles/.profile&#34;</span><span class="p">,</span>
        <span class="nt">&#34;dest&#34;</span><span class="p">:</span> <span class="s2">&#34;.profile&#34;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;i3&#34;</span><span class="p">,</span>
        <span class="nt">&#34;src&#34;</span><span class="p">:</span> <span class="s2">&#34;dotfiles/i3&#34;</span><span class="p">,</span>
        <span class="nt">&#34;dest&#34;</span><span class="p">:</span> <span class="s2">&#34;.config/i3&#34;</span>
      <span class="p">},</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre></div></p>
<p>As can be seen, the JSON file has an array variable <code>linking</code>, which can be used to set the paths for each configuration file and folder. The <code>configure.py</code> script also requires a <code>dotfiles</code> folder to be present in the current directory. The folder can be created manually, or if it is already version controlled on GitHub, then the script can clone it. For that, you can edit the <code>pre</code> section in the <code>dotfiles.json</code>.</p>
<p>Your dotfiles and config folders go inside the <code>dotfiles</code> folder. You need to copy all your current configurations to this folder to get started.</p>
<p>So, how does the script know where a file or folder will be linked? Simple, you need to edit the <code>dotfiles.json</code> file and add source and destination locations. For example, if you want to set up configurations of <code>i3</code> to its original location (which is, <code>$HOME/.config/i3</code>), then you need to create a new JSON object in the <code>linking</code> array, like this.
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;i3&#34;</span><span class="p">,</span>
  <span class="nt">&#34;src&#34;</span><span class="p">:</span> <span class="s2">&#34;dotfiles/i3&#34;</span><span class="p">,</span>
  <span class="nt">&#34;dest&#34;</span><span class="p">:</span> <span class="s2">&#34;.config/i3&#34;</span>
<span class="p">}</span></code></pre></div></p>
<p>Here the <code>name</code> is used to identify the configuration file, the <code>src</code> parameter is the location of your config file/folder in the dotfiles directory, and the <code>dest</code> parameter is the final destination of the file/folder. Keen observers would notice that I have not used <code>$HOME</code> anywhere. It is understood that the configuration will go to the current user&rsquo;s home directory. So the <code>dest</code> is relative to the user&rsquo;s home directory, and <code>src</code> is relative to the directory from which the <code>configure.py</code> script is executed.</p>
<p>And you are done! Now, run <code>configure.py</code>, and all your dotfiles and folders will be symlinked to their correct place.</p>
<p>The <code>current_status</code> file saves all the symlink locations that are being managed by the script, for your easy reference and to debug any error.</p>
<h2 id="behind-the-scenes">Behind the Scenes</h2>
<p>A lot to cool things happen behind the scenes. The script will check if any previous symlink exists at the given <code>dest</code> location. It removes any symlinks to avoid redundancy. If the dest already has any dotfile or folder, then it backs it up in the <code>.backups</code> under today&rsquo;s date and time before replacing it with a symlink to avoid any potential data loss.</p>
<p>I hope the article was useful. Cheers 😄</p>
]]></content>
            
                 
                    
                         
                        
                            
                             
                                <category scheme="https://yashagarwal.in/categories/technical" term="technical" label="Technical" />
                            
                        
                    
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://yashagarwal.in/tags/configuration" term="configuration" label="configuration" />
                             
                                <category scheme="https://yashagarwal.in/tags/python" term="python" label="python" />
                             
                                <category scheme="https://yashagarwal.in/tags/github" term="github" label="github" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[Setting up Hugo automatic deployment to Github with Wercker]]></title>
            <link href="https://yashagarwal.in/posts/2017/02/setting-up-hugo-automatic-deployment-to-github-with-wercker/?utm_source=atom_feed" rel="alternate" type="text/html" />
            
            
                <id>https://yashagarwal.in/posts/2017/02/setting-up-hugo-automatic-deployment-to-github-with-wercker/</id>
            
            
                    <author>
                        <name>Yash Agarwal</name>
                    </author>
            <published>2017-02-22T13:37:56+05:30</published>
            <updated>2017-02-22T13:37:56+05:30</updated>
            
            
            <content type="html"><![CDATA[



    

    
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />

    
    <link rel="stylesheet" href="/css/photoswipe.min.d780348a887d97b4d6cc664301a2941706e4a02aeb1533524fcce3b7b9b64b4f.css">

    

    
    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
        
        <div class="pswp__bg"></div>
        
        <div class="pswp__scroll-wrap">
            
            <div class="pswp__container">
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
            </div>
            
            <div class="pswp__ui pswp__ui--hidden">
                <div class="pswp__top-bar">
                    
                    <div class="pswp__counter"></div>
                    <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                    <button class="pswp__button pswp__button--share" title="Share"></button>
                    <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                    <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                    
                    
                    <div class="pswp__preloader">
                        <div class="pswp__preloader__icn">
                            <div class="pswp__preloader__cut">
                                <div class="pswp__preloader__donut"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                    <div class="pswp__share-tooltip"></div>
                </div>
                <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
                </button>
                <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
                </button>
                <div class="pswp__caption">
                    <div class="pswp__caption__center"></div>
                </div>
            </div>
        </div>
    </div>

<p>Recently, I again migrated my blog from Pelican to Hugo. So till now, I have experimented with Wordpress, Jekyll, Pelican, and Hugo. Without any doubt, Hugo is the simplest to set up. This time, I have setup Hugo in Windows, as I think, in my system, I reinstall Windows OS much less frequently than the Linux. So that way, it will be less painful for me to set up the blog again.</p>
<p>In this post, I will list all the process which I used to set up automatic deployment of Hugo generated site to Github pages using Wercker. In the beginning, I was trying to use Travis-CI, but then I read about Wercker somewhere. I was impressed with the integration of Wercker with Hugo and the availability of many its community-generated “steps” for the build and deploy process.</p>
<p><a href="https://gohugo.io/overview/introduction/">Hugo Docs</a> already have a fantastic <a href="https://gohugo.io/tutorials/automated-deployments/">documentation</a> for setting up Hugo with Wercker, but it is outdated. Other documentations available on-line is also obsolete. Wercker has changed many functionalities in its platform, which made it difficult for me to set up things correctly. But after hours of trial and error cycle, I was able to build and deploy my static files successfully.</p>
<p>Here I would like to share the issues I encountered and the tweaks I’ve made. The source codes of this site can be found <a href="https://github.com/yash2696/yash2696.github.io">here</a>.</p>
<h2 id="project-pages-or-user-pages">Project Pages or User Pages</h2>
<p>Two types of sites are supported on Github Pages, User Site, and Project Site. User Sites will serve the files stored in the master branch of the repository <code>https://github.com/user_name/user_name.github.io</code> at the address <code>https://user_name.github.io.</code> For the Project sites, everything under the gh-pages will be served at the address <code>https://repo_name.github.io</code>.</p>
<p>My site is a User site, so I wanted all the static files to be saved in the master branch. As Hugo generates all the static files under <code>public</code> directory, I needed another branch to store my source files. So my made a new branch <code>source</code>, which will save all the source files for my blog. Don’t forget to remove the <code>.git</code> folder from the theme folder. Otherwise, the build will fail at a later stage. You can try using the git submodule feature to avoid this issue. I created a repository <code>yash2696.github.io</code> in Github also.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">git init                       <span class="c1">#initialized git repository in site root</span>
git checkout -b <span class="nb">source</span>         <span class="c1">#created new branch source</span>
git remote add origin https://github.com/yash2696/yash2696.github.io
git add .
git commit -m <span class="s2">&#34;Initial Commit&#34;</span>
git push origin source</code></pre></div>
<p>Then I initialized my master branch as a orphan branch.
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">git checkout --orphan master
git rm -rf .
rm -f <span class="s1">&#39;.gitignore&#39;</span>
<span class="nb">echo</span> <span class="s2">&#34;#Your repository name&#34;</span> &gt; README.md
git add README.md
git commit -a -m <span class="s2">&#34;Initial Commit&#34;</span>
git push origin master</code></pre></div></p>
<h2 id="automatic-deployment-using-wrecker">Automatic deployment using Wrecker</h2>
<p>It is straightforward to build a Hugo site. Invoke <code>hugo</code> command under your root directory, Hugo will create a public folder which will contain all your content, static files, etc. Then push this directory to Github, and voila, your site is up!</p>
<p>What if a single push to <code>source</code> branch can trigger all the process for you automatically. Here the magic of continuous integration(CI) comes into the picture. A free Wercker account can be easily created and hooked to the Github account and a new application from a chosen repository. After setting up everything, a push to the development branch will automatically trigger the Wercker. One of the most significant advantages of using Wercker is its extensive collection of user-made and well documented &ldquo;steps&rdquo;. In this post, I will use two steps, <code>build hugo</code> and <code>deploy to Github</code>.</p>



    <link rel="stylesheet" href="/css/hugo-easy-gallery.css">
    


<div class="box fancy-figure caption-position-bottom caption-effect-appear"  itemscope itemtype="http://schema.org/ImageGallery">
    <figure  itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
        <div class="img">
            <img itemprop="thumbnail" src="/images/2017-02-22/wercker-steps.png" alt="Wercker → Registry → steps"/>
        </div>
        <a href="/images/2017-02-22/wercker-steps.png" itemprop="contentUrl"></a>
            <figcaption>
                    <p>Wercker → Registry → steps</p>
            </figcaption>
    </figure>
</div>

<p>The first task is to create a <code>wercker.yml</code> file. It will tell Wercker which all actions, it should perform. Here is my <a href="https://raw.githubusercontent.com/yash2696/yash2696.github.io/source/wercker.yml">wercker.yml</a> for reference. In this, I have used two pipelines, <em>build</em> and <em>deploy</em>. Please follow the official docs for the more detailed steps. I will list all the problems which I face while setting up things properly.</p>
<h3 id="build">Build</h3>
<p>Following the official guide, I used this <a href="https://github.com/ArjenSchwarz/wercker-step-hugo-build">step</a> to trigger Hugo to build HTML pages. I had already removed git repository information from the theme folder, so this step finished successfully. If you haven’t, you may add the following piece of code in your build step.
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">- script:
    name: install git
    code: <span class="p">|</span>
        apt-get update
        apt-get install git -y
    - script:
        name: initialize git submodules
        code: <span class="p">|</span>
            git submodule update --init --recursive</code></pre></div></p>
<h3 id="deploy">Deploy</h3>
<p>There is no concept named &ldquo;Add Deploy Target&rdquo; in Wercker as of now. Most of the on-line tutorials follow this process which is outdated. Now Wercker uses a concept called &ldquo;Workflows in Pipelines&rdquo;.</p>
<p>For new interface, even if you add a deploy stage in the <code>wercker.yml</code>, you will have to create a new pipeline <code>deploy</code> under the Workflows tab. After creating the pipeline, the &ldquo;YML Pipeline name&rdquo; must be set to the deploy stage name, which in this case is <code>deploy</code>.</p>
<p>In <code>deploy</code> stage, I used this <a href="https://app.wercker.com/applications/55af22c5f32b86a9290ec706/tab/details/">step</a> to deploy the built site to Github. Each pipeline starts from scratch, so for the deploy pipeline, the git package needs to be installed again. One also has to set up the environment variable <code>$GIT_TOKEN</code> to each pipeline, acquired from Github setting.</p>



<div class="box fancy-figure caption-position-bottom caption-effect-appear"  itemscope itemtype="http://schema.org/ImageGallery">
    <figure  itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
        <div class="img">
            <img itemprop="thumbnail" src="/images/2017-02-22/wercker-pipeline.png" alt="Wercker Pipeline"/>
        </div>
        <a href="/images/2017-02-22/wercker-pipeline.png" itemprop="contentUrl"></a>
            <figcaption>
                    <p>Wercker Pipeline</p>
            </figcaption>
    </figure>
</div>

<p>You need to generate a new access token for your deploy stage from Github settings.



<div class="box fancy-figure caption-position-bottom caption-effect-appear"  itemscope itemtype="http://schema.org/ImageGallery">
    <figure  itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
        <div class="img">
            <img itemprop="thumbnail" src="/images/2017-02-22/wercker-access-token.png" alt="Github Access Token"/>
        </div>
        <a href="/images/2017-02-22/wercker-access-token.png" itemprop="contentUrl"></a>
            <figcaption>
                    <p>Github Access Token</p>
            </figcaption>
    </figure>
</div>
</p>
<p>After adding the deploy stage, add the token you obtained from the Github to Environmental Variables in deploy pipeline.</p>



<div class="box fancy-figure caption-position-bottom caption-effect-appear"  itemscope itemtype="http://schema.org/ImageGallery">
    <figure  itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
        <div class="img">
            <img itemprop="thumbnail" src="/images/2017-02-22/wercker-token.png" alt="Wercker Token"/>
        </div>
        <a href="/images/2017-02-22/wercker-token.png" itemprop="contentUrl"></a>
            <figcaption>
                    <p>Wercker Token</p>
            </figcaption>
    </figure>
</div>

<p>On the next push to your development branch, Wercker will automatically build the site and deploy it on Github Pages.</p>
]]></content>
            
                 
                    
                         
                        
                            
                             
                                <category scheme="https://yashagarwal.in/categories/technical" term="technical" label="Technical" />
                            
                        
                    
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://yashagarwal.in/tags/gh-pages" term="gh-pages" label="gh-pages" />
                             
                                <category scheme="https://yashagarwal.in/tags/hugo" term="hugo" label="Hugo" />
                             
                                <category scheme="https://yashagarwal.in/tags/github" term="github" label="Github" />
                             
                                <category scheme="https://yashagarwal.in/tags/wercker" term="wercker" label="Wercker" />
                            
                        
                    
                
            
        </entry>
    
</feed>
